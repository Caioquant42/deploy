zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
dtypes após leitura:
symbol               object
time                 object
spot_price          float64
spot_symbol          object
option_type          object
due_date             object
strike              float64
premium             float64
maturity_type        object
days_to_maturity      int64
moneyness            object
delta               float64
gamma               float64
vega                float64
theta               float64
rho                 float64
volatility          float64
poe                 float64
bs                  float64
dtype: object
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 17:30:37
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to all_tickers_last_time_data.json
Code last executed at: 2025-03-06 17:30:38
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:15:16
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:15:16
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:20:20
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:20:20
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:25:14
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:25:15
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:30:11
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:30:12
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:35:11
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:35:11
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:40:11
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:40:12
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:45:17
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:45:17
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:50:11
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:50:12
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 18:55:16
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 18:55:16
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:00:20
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:00:21
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:05:14
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:05:15
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:10:17
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:10:18
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:15:21
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:15:21
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:20:19
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:20:20
zommalab database already exists
vanilla table already exists in zommalab database
zommalab database and vanilla table setup completed with RANGE partitioning.
Options Data for PETR4 retrieved successfully.
Data has been written to PETR4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for PETR4 loaded successfully into DolphinDB! Inserted 2220 rows.
Options Data for VALE3 retrieved successfully.
Data has been written to VALE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for VALE3 loaded successfully into DolphinDB! Inserted 1270 rows.
Options Data for BOVA11 retrieved successfully.
Data has been written to BOVA11_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BOVA11 loaded successfully into DolphinDB! Inserted 1714 rows.
Options Data for BBAS3 retrieved successfully.
Data has been written to BBAS3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBAS3 loaded successfully into DolphinDB! Inserted 864 rows.
Options Data for BBDC4 retrieved successfully.
Data has been written to BBDC4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for BBDC4 loaded successfully into DolphinDB! Inserted 637 rows.
Options Data for COGN3 retrieved successfully.
Data has been written to COGN3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for COGN3 loaded successfully into DolphinDB! Inserted 224 rows.
Options Data for MGLU3 retrieved successfully.
Data has been written to MGLU3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for MGLU3 loaded successfully into DolphinDB! Inserted 644 rows.
Options Data for ITUB4 retrieved successfully.
Data has been written to ITUB4_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for ITUB4 loaded successfully into DolphinDB! Inserted 657 rows.
Options Data for WEGE3 retrieved successfully.
Data has been written to WEGE3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for WEGE3 loaded successfully into DolphinDB! Inserted 629 rows.
Options Data for EMBR3 retrieved successfully.
Data has been written to EMBR3_options.csv
Unique values in 'option_type': ['CALL' 'PUT']
Options data for EMBR3 loaded successfully into DolphinDB! Inserted 579 rows.
Total rows inserted across all symbols: 9438
Tickers with unavailable information: []
Removed 9438 duplicate entries from the vanilla table.
Total rows in the vanilla table after removing duplicates:     count
0  726138
Failed tickers saved to failed_tickers.txt
Cleaning CSV data
All .csv files deleted.
Code last executed at: 2025-03-06 19:25:16
Running update_surface_data.py...
update_surface_data.py completed successfully.
Fetched 12477 rows from the vanilla table.
Created PETR4 DataFrame with 2765 rows.

Last available time for PETR4: 2025-03-05 00:00:00
Number of rows with the last available time: 716

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility    poe moneyness
9602     PETRA2 2025-03-05       34.62  ...     30.514  17.88       OTM
9603     PETRA3 2025-03-05       34.62  ...     43.167  21.76       OTM
9604   PETRA364 2025-03-05       34.62  ...     71.680  48.14       ITM
9605   PETRA370 2025-03-05       34.62  ...     39.733  37.20       OTM
9606   PETRA474 2025-03-05       34.62  ...     32.462  28.98       OTM
...         ...        ...         ...  ...        ...    ...       ...
10313  PETRX435 2025-03-05       34.62  ...     17.161  76.47       ITM
10314   PETRX44 2025-03-05       34.62  ...      4.054  99.90       ITM
10315  PETRX450 2025-03-05       34.62  ...      9.453  77.42       ITM
10316   PETRX46 2025-03-05       34.62  ...     27.931  77.88       ITM
10317   PETRX55 2025-03-05       34.62  ...     16.154  29.85       OTM

[716 rows x 11 columns]>
Created VALE3 DataFrame with 1755 rows.

Last available time for VALE3: 2025-03-05 00:00:00
Number of rows with the last available time: 364

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10318  VALEA530 2025-03-05       55.59  ...     43.509   43.66       ATM
10319  VALEA580 2025-03-05       55.59  ...     38.940   44.22       ATM
10320  VALEA587 2025-03-05       55.59  ...     36.894   38.86       OTM
10321  VALEA780 2025-03-05       55.59  ...     28.221   11.06       OTM
10322  VALEC409 2025-03-05       55.59  ...    103.821   89.92       ITM
...         ...        ...         ...  ...        ...     ...       ...
10677  VALET566 2025-03-05       55.59  ...     13.094   52.43       ATM
10678  VALEX550 2025-03-05       55.59  ...     13.836   44.13       ATM
10679   VALEX57 2025-03-05       55.59  ...     10.763   47.54       ATM
10680  VALEX580 2025-03-05       55.59  ...     10.633   62.75       ATM
10681  VALEX660 2025-03-05       55.59  ...      1.873  100.00       ITM

[364 rows x 11 columns]>
Created BOVA11 DataFrame with 2275 rows.

Last available time for BOVA11: 2025-03-05 00:00:00
Number of rows with the last available time: 501

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
10682  BOVAA125 2025-03-05      120.05  ...     29.146   41.32       ATM
10683  BOVAB125 2025-03-05      120.05  ...     29.021   41.47       ATM
10684  BOVAB127 2025-03-05      120.05  ...     24.181   39.32       OTM
10685  BOVAB140 2025-03-05      120.05  ...     24.514   25.20       OTM
10686    BOVAC1 2025-03-05      120.05  ...     29.423   36.59       OTM
...         ...        ...         ...  ...        ...     ...       ...
11178  BOVAX150 2025-03-05      120.05  ...      0.000  100.00       ITM
11179  BOVAX169 2025-03-05      120.05  ...      0.000  100.00       ITM
11180  BOVAX180 2025-03-05      120.05  ...      0.000  100.00       ITM
11181   BOVAX19 2025-03-05      120.05  ...      7.263   46.82       ATM
11182    BOVAX2 2025-03-05      120.05  ...      0.000  100.00       ITM

[501 rows x 11 columns]>
Created BBAS3 DataFrame with 1176 rows.

Last available time for BBAS3: 2025-03-05 00:00:00
Number of rows with the last available time: 260

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11183  BBASA151 2025-03-05       27.77  ...     64.515   60.54       ITM
11184   BBASA25 2025-03-05       27.77  ...     88.544   78.51       ITM
11185  BBASA301 2025-03-05       27.77  ...     39.049   36.16       OTM
11186  BBASB270 2025-03-05       27.77  ...     42.341   42.55       ATM
11187  BBASC197 2025-03-05       27.77  ...      0.000  100.00       ITM
...         ...        ...         ...  ...        ...     ...       ...
11438  BBAST271 2025-03-05       27.77  ...     16.453   26.95       OTM
11439  BBASV500 2025-03-05       27.77  ...     20.530    8.93       OTM
11440  BBASW540 2025-03-05       27.77  ...     16.665   18.98       OTM
11441  BBASX281 2025-03-05       27.77  ...      9.270   45.55       ATM
11442  BBASX300 2025-03-05       27.77  ...     10.155   61.25       ATM

[260 rows x 11 columns]>
Created BBDC4 DataFrame with 873 rows.

Last available time for BBDC4: 2025-03-05 00:00:00
Number of rows with the last available time: 179

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11443    BBDCA120 2025-03-05       11.47  ...     40.246   48.82       ATM
11444     BBDCB13 2025-03-05       11.47  ...     42.167   32.95       OTM
11445    BBDCC102 2025-03-05       11.47  ...     55.143   84.84       ITM
11446    BBDCC106 2025-03-05       11.47  ...     54.431   79.90       ITM
11447  BBDCC110W1 2025-03-05       11.47  ...      0.000  100.00       ATM
...           ...        ...         ...  ...        ...     ...       ...
11617     BBDCS13 2025-03-05       11.47  ...      0.000  100.00       ITM
11618    BBDCS140 2025-03-05       11.47  ...      0.000  100.00       ITM
11619     BBDCT11 2025-03-05       11.47  ...     13.747   35.82       ATM
11620    BBDCT150 2025-03-05       11.47  ...      6.051   99.97       ITM
11621    BBDCT160 2025-03-05       11.47  ...      0.000  100.00       ITM

[179 rows x 11 columns]>
Created COGN3 DataFrame with 302 rows.

Last available time for COGN3: 2025-03-05 00:00:00
Number of rows with the last available time: 73

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
11622   COGNA10 2025-03-05        1.56  ...     75.403   47.49       ITM
11623    COGNB3 2025-03-05        1.56  ...     72.031   33.16       ATM
11624  COGNC120 2025-03-05        1.56  ...     84.950   90.79       ITM
11625  COGNC135 2025-03-05        1.56  ...     80.118   77.19       ITM
11626  COGNC140 2025-03-05        1.56  ...     67.227   74.88       ITM
...         ...        ...         ...  ...        ...     ...       ...
11690  COGNQ115 2025-03-05        1.56  ...     65.107   18.48       OTM
11691  COGNR139 2025-03-05        1.56  ...      0.000  100.00       ITM
11692  COGNT400 2025-03-05        1.56  ...      0.000  100.00       ITM
11693  COGNV170 2025-03-05        1.56  ...     41.866   65.01       ITM
11694    COGNW2 2025-03-05        1.56  ...     30.536   50.78       ATM

[73 rows x 11 columns]>
Created MGLU3 DataFrame with 850 rows.

Last available time for MGLU3: 2025-03-05 00:00:00
Number of rows with the last available time: 197

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility     poe moneyness
11695    MGLUC101 2025-03-05        7.28  ...     82.607    2.69       OTM
11696    MGLUC104 2025-03-05        7.28  ...     78.217    1.50       OTM
11697    MGLUC510 2025-03-05        7.28  ...      0.000  100.00       ITM
11698  MGLUC560W1 2025-03-05        7.28  ...    153.388   96.80       ITM
11699  MGLUC560W2 2025-03-05        7.28  ...      0.000  100.00       ITM
...           ...        ...         ...  ...        ...     ...       ...
11887    MGLUR470 2025-03-05        7.28  ...     66.955   15.54       OTM
11888    MGLUR600 2025-03-05        7.28  ...     50.492   46.61       OTM
11889    MGLUR990 2025-03-05        7.28  ...     59.594   85.98       ITM
11890    MGLUU670 2025-03-05        7.28  ...     57.591   49.92       OTM
11891    MGLUU710 2025-03-05        7.28  ...     52.891   54.26       ATM

[197 rows x 11 columns]>
Created ITUB4 DataFrame with 868 rows.

Last available time for ITUB4: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of            symbol       time  spot_price  ... volatility    poe moneyness
11892    ITUBC231 2025-03-05        32.4  ...    121.863  91.93       ITM
11893    ITUBC288 2025-03-05        32.4  ...     59.134  89.70       ITM
11894    ITUBC301 2025-03-05        32.4  ...     50.514  90.92       ITM
11895    ITUBC306 2025-03-05        32.4  ...     49.451  88.53       ITM
11896  ITUBC309W2 2025-03-05        32.4  ...     42.143  91.01       ITM
...           ...        ...         ...  ...        ...    ...       ...
12074    ITUBQ284 2025-03-05        32.4  ...     17.974  17.99       OTM
12075    ITUBQ336 2025-03-05        32.4  ...     15.803  35.41       ATM
12076    ITUBQ356 2025-03-05        32.4  ...      7.759  91.04       ATM
12077    ITUBT210 2025-03-05        32.4  ...     37.944   0.76       OTM
12078    ITUBX319 2025-03-05        32.4  ...     14.883  30.94       OTM

[187 rows x 11 columns]>
Created WEGE3 DataFrame with 917 rows.

Last available time for WEGE3: 2025-03-05 00:00:00
Number of rows with the last available time: 187

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12079  WEGEC404 2025-03-05       47.65  ...     48.779   94.20       ITM
12080  WEGEC412 2025-03-05       47.65  ...     45.345   93.46       ITM
12081  WEGEC449 2025-03-05       47.65  ...     40.082   76.37       ITM
12082  WEGEC459 2025-03-05       47.65  ...     34.977   70.70       ATM
12083  WEGEC464 2025-03-05       47.65  ...     34.512   68.46       ATM
...         ...        ...         ...  ...        ...     ...       ...
12261  WEGER480 2025-03-05       47.65  ...     16.776   49.85       ATM
12262   WEGES44 2025-03-05       47.65  ...     19.708   26.45       OTM
12263  WEGEW542 2025-03-05       47.65  ...      0.000  100.00       ITM
12264  WEGEX457 2025-03-05       47.65  ...     15.684   34.91       OTM
12265  WEGEX600 2025-03-05       47.65  ...      0.000  100.00       ITM

[187 rows x 11 columns]>
Created EMBR3 DataFrame with 696 rows.

Last available time for EMBR3: 2025-03-05 00:00:00
Number of rows with the last available time: 211

First few rows of the last time data:
<bound method NDFrame.head of          symbol       time  spot_price  ... volatility     poe moneyness
12266  EMBRC257 2025-03-05       75.85  ...      0.000  100.00       ITM
12267  EMBRC550 2025-03-05       75.85  ...      0.000  100.00       ITM
12268  EMBRC560 2025-03-05       75.85  ...     96.179   91.07       ITM
12269  EMBRC570 2025-03-05       75.85  ...      0.000  100.00       ITM
12270  EMBRC580 2025-03-05       75.85  ...     72.822   94.68       ITM
...         ...        ...         ...  ...        ...     ...       ...
12472  EMBRQ725 2025-03-05       75.85  ...     34.300   40.57       ATM
12473  EMBRR620 2025-03-05       75.85  ...     40.455   20.69       OTM
12474  EMBRV510 2025-03-05       75.85  ...     38.349   11.92       OTM
12475  EMBRV560 2025-03-05       75.85  ...     43.726   23.37       OTM
12476  EMBRV610 2025-03-05       75.85  ...     33.814   23.71       OTM

[211 rows x 11 columns]>

Saved last available time data for all tickers to /var/www/fullstack/backend/apps/endpoint/utils/all_tickers_last_time_data.json
Code last executed at: 2025-03-06 19:25:16
